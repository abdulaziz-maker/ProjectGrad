{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">💼 الوظائف المتاحة</h1>

    <!-- زر "إضافة وظيفة" يظهر فقط لأصحاب العمل (Employer) وليس للأدمن -->
    {% if current_user.is_authenticated and current_user.role == "Employer" %}
        <div class="text-center my-4">
            <a href="{{ url_for('main.add_job') }}" class="btn btn-primary">➕ إضافة وظيفة</a>
        </div>
    {% endif %}

    {% if jobs %}
        <div class="row justify-content-center">
            {% for job in jobs %}
                <div class="col-md-6 d-flex">
                    <div class="card my-3 job-card shadow-sm border-0 w-100">
                        <div class="card-body">
                            <h5 class="card-title text-primary">📌 {{ job.title }}</h5>
                            <p class="card-text">{{ job.description }}</p>
                            <p class="card-text"><strong>🏢 الشركة:</strong> {{ job.company }}</p>
                            <p class="card-text"><strong>📅 تاريخ النشر:</strong> {{ job.posted_date.strftime('%Y-%m-%d') }}</p>

                            <!-- زر "التقديم على الوظيفة" يظهر فقط للباحثين عن عمل (JobSeeker) وليس للأدمن -->
                            {% if current_user.is_authenticated and current_user.role == "JobSeeker" %}
                                <a href="#" class="btn btn-success">📩 التقديم على الوظيفة</a>
                            {% endif %}

                            <!-- زر "تعديل" و "حذف" يظهر فقط لصاحب الوظيفة (Employer) وليس للأدمن -->
                            {% if current_user.is_authenticated and job.employer_id == current_user.id and current_user.role == "Employer" %}
                                <a href="{{ url_for('main.edit_job', job_id=job.id) }}" class="btn btn-warning">✏️ تعديل</a>
                                <a href="{{ url_for('main.delete_job', job_id=job.id) }}" class="btn btn-danger" onclick="return confirm('⚠️ هل أنت متأكد أنك تريد حذف هذه الوظيفة؟');">🗑️ حذف</a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info text-center" role="alert">
            ❌ لا توجد وظائف متاحة حاليًا. حاول مرة أخرى لاحقًا.
        </div>
    {% endif %}
</div>
{% endblock %}
